package handshake_test

import (
	"testing"

	"github.com/arailly/mytls13/handshake"
)

func TestParseExtensions(t *testing.T) {
	// setup
	extBytes := []byte{
		0x00, 0x2b, 0x00, 0x02, 0x03, 0x04,
		0x00, 0x33, 0x00, 0x24, 0x00, 0x1d, 0x00, 0x20,
		0x2f, 0xe5, 0x7d, 0xa3, 0x47, 0xcd, 0x62, 0x43,
		0x15, 0x28, 0xda, 0xac, 0x5f, 0xbb, 0x29, 0x07,
		0x30, 0xff, 0xf6, 0x84, 0xaf, 0xc4, 0xcf, 0xc2,
		0xed, 0x90, 0x99, 0x5f, 0x58, 0xcb, 0x3b, 0x74,
	}

	// exercise
	actual := handshake.ParseExtensions(extBytes)

	// verify
	if len(actual) != 2 {
		t.Fatal(len(actual))
	}
}
